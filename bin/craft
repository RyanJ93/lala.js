#!/usr/bin/env node

'use strict';

const filesystem = require('fs');
const lala = require('../index');

async function copyTemplateDir(template, destination){
    await filesystem.readdir(template, async (error, files) => {
        if ( !filesystem.existsSync(destination) ){
            filesystem.mkdirSync(destination);
        }
        if ( files === null ){
            return;
        }
        let processes = [];
        files.forEach((file) => {
            if ( filesystem.lstatSync(template + '/' + file).isDirectory() ){
                processes.push(copyTemplateDir(template + '/' + file, destination + '/' + file));
                return;
            }
            filesystem.copyFileSync(template + '/' + file, destination + '/' + file);
        });
        await Promise.all(processes);
    });
}

const TEMPLATES = {
    base: './resources/app-templates/base/'
};

let template = TEMPLATES.base;
let destination = './project';

console.log('Welcome to Lala.js, I\'m crafting a new sample project just for you! üíô');
copyTemplateDir(template, destination).then(() => {
    console.log('Your project is ready to try out, have fun! ‚ò∫Ô∏è');
});
